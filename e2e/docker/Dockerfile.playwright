FROM mcr.microsoft.com/playwright:v1.58.0@sha256:35c7d48b4ccaf3aca5018f5f1bf7f50c7da7d61d176c530741f4f2e9ca336c34

WORKDIR /app

# Enable pnpm via corepack and install dependencies
RUN corepack enable && corepack prepare pnpm@10.28.1 --activate && \
  pnpm install "@playwright/test@1.58.0" "dotenv@^16.3.1" "@grafana/plugin-e2e" "@grafana/i18n@^12.3.0"

ENV TZ=Europe/Madrid

ENTRYPOINT ["pnpm", "exec", "playwright", "test", "-c", "e2e/config/playwright.config.ci.ts"]
